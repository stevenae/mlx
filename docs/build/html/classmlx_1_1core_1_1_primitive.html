<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MLX: mlx::core::Primitive Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MLX
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacemlx.html">mlx</a></li><li class="navelem"><a class="el" href="namespacemlx_1_1core.html">core</a></li><li class="navelem"><a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classmlx_1_1core_1_1_primitive-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">mlx::core::Primitive Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="primitives_8h_source.html">primitives.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for mlx::core::Primitive:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classmlx_1_1core_1_1_primitive.png" usemap="#mlx::core::Primitive_map" alt=""/>
  <map id="mlx::core::Primitive_map" name="mlx::core::Primitive_map">
<area href="classmlx_1_1core_1_1_compiled.html" alt="mlx::core::Compiled" shape="rect" coords="211,56,412,80"/>
<area href="classmlx_1_1core_1_1_custom_transforms.html" alt="mlx::core::CustomTransforms" shape="rect" coords="211,112,412,136"/>
<area href="classmlx_1_1core_1_1_depends.html" alt="mlx::core::Depends" shape="rect" coords="211,168,412,192"/>
<area href="classmlx_1_1core_1_1_div_mod.html" alt="mlx::core::DivMod" shape="rect" coords="211,224,412,248"/>
<area href="classmlx_1_1core_1_1_q_r_f.html" alt="mlx::core::QRF" shape="rect" coords="211,280,412,304"/>
<area href="classmlx_1_1core_1_1_s_v_d.html" alt="mlx::core::SVD" shape="rect" coords="211,336,412,360"/>
<area href="classmlx_1_1core_1_1_split.html" alt="mlx::core::Split" shape="rect" coords="211,392,412,416"/>
<area href="classmlx_1_1core_1_1_unary_primitive.html" alt="mlx::core::UnaryPrimitive" shape="rect" coords="211,448,412,472"/>
<area href="classmlx_1_1core_1_1distributed_1_1_dist_primitive.html" alt="mlx::core::distributed::DistPrimitive" shape="rect" coords="211,504,412,528"/>
<area href="classmlx_1_1core_1_1fast_1_1_custom.html" alt="mlx::core::fast::Custom" shape="rect" coords="211,560,412,584"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afc69f22ee1f6e8a9ecc2c3a8f43b8fdb" id="r_afc69f22ee1f6e8a9ecc2c3a8f43b8fdb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afc69f22ee1f6e8a9ecc2c3a8f43b8fdb">Primitive</a> (<a class="el" href="structmlx_1_1core_1_1_stream.html">Stream</a> <a class="el" href="#a46e6257397a662528f9f831842ac456a">stream</a>)</td></tr>
<tr class="separator:afc69f22ee1f6e8a9ecc2c3a8f43b8fdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ae61e3289c4134232a69295268f8261" id="r_a8ae61e3289c4134232a69295268f8261"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structmlx_1_1core_1_1_device.html">Device</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8ae61e3289c4134232a69295268f8261">device</a> ()</td></tr>
<tr class="memdesc:a8ae61e3289c4134232a69295268f8261"><td class="mdescLeft">&#160;</td><td class="mdescRight">The device the primitive will run on.  <br /></td></tr>
<tr class="separator:a8ae61e3289c4134232a69295268f8261"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46e6257397a662528f9f831842ac456a" id="r_a46e6257397a662528f9f831842ac456a"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structmlx_1_1core_1_1_stream.html">Stream</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46e6257397a662528f9f831842ac456a">stream</a> ()</td></tr>
<tr class="memdesc:a46e6257397a662528f9f831842ac456a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The stream the primitive will run on.  <br /></td></tr>
<tr class="separator:a46e6257397a662528f9f831842ac456a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1596dc50b910538eae14878e98f07575" id="r_a1596dc50b910538eae14878e98f07575"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1596dc50b910538eae14878e98f07575">eval_cpu</a> (const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;inputs, std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;outputs)=0</td></tr>
<tr class="memdesc:a1596dc50b910538eae14878e98f07575"><td class="mdescLeft">&#160;</td><td class="mdescRight">A primitive must know how to evaluate itself on the CPU/GPU for the given inputs and populate the output arrays.  <br /></td></tr>
<tr class="separator:a1596dc50b910538eae14878e98f07575"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad217376dcf5eff691d731566faec2ba2" id="r_ad217376dcf5eff691d731566faec2ba2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad217376dcf5eff691d731566faec2ba2">eval_gpu</a> (const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;inputs, std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;outputs)=0</td></tr>
<tr class="separator:ad217376dcf5eff691d731566faec2ba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fecf38f53da08ba1947543c2b3158c2" id="r_a9fecf38f53da08ba1947543c2b3158c2"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9fecf38f53da08ba1947543c2b3158c2">jvp</a> (const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;primals, const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;tangents, const std::vector&lt; int &gt; &amp;argnums)</td></tr>
<tr class="memdesc:a9fecf38f53da08ba1947543c2b3158c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The Jacobian-vector product.  <br /></td></tr>
<tr class="separator:a9fecf38f53da08ba1947543c2b3158c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dcb6807326eeab62474c6a0e3836d42" id="r_a1dcb6807326eeab62474c6a0e3836d42"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1dcb6807326eeab62474c6a0e3836d42">vjp</a> (const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;primals, const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;cotangents, const std::vector&lt; int &gt; &amp;argnums, const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;outputs)</td></tr>
<tr class="memdesc:a1dcb6807326eeab62474c6a0e3836d42"><td class="mdescLeft">&#160;</td><td class="mdescRight">The vector-Jacobian product.  <br /></td></tr>
<tr class="separator:a1dcb6807326eeab62474c6a0e3836d42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac632b9619dd7a6a0f177bd36202e8103" id="r_ac632b9619dd7a6a0f177bd36202e8103"><td class="memItemLeft" align="right" valign="top">virtual std::pair&lt; std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt;, std::vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac632b9619dd7a6a0f177bd36202e8103">vmap</a> (const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;inputs, const std::vector&lt; int &gt; &amp;axes)</td></tr>
<tr class="memdesc:ac632b9619dd7a6a0f177bd36202e8103"><td class="mdescLeft">&#160;</td><td class="mdescRight">The primitive must know how to vectorize itself across the given axes.  <br /></td></tr>
<tr class="separator:ac632b9619dd7a6a0f177bd36202e8103"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1aff91354ce036596088a3e19474ecb" id="r_ae1aff91354ce036596088a3e19474ecb"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae1aff91354ce036596088a3e19474ecb">print</a> (std::ostream &amp;os)=0</td></tr>
<tr class="memdesc:ae1aff91354ce036596088a3e19474ecb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the primitive.  <br /></td></tr>
<tr class="separator:ae1aff91354ce036596088a3e19474ecb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6140a502af4c2bbbc776ab26e9afebcd" id="r_a6140a502af4c2bbbc776ab26e9afebcd"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6140a502af4c2bbbc776ab26e9afebcd">is_equivalent</a> (const <a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a> &amp;other) const</td></tr>
<tr class="memdesc:a6140a502af4c2bbbc776ab26e9afebcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Equivalence check defaults to false unless overridden by the primitive.  <br /></td></tr>
<tr class="separator:a6140a502af4c2bbbc776ab26e9afebcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8849dc20991398f6f9a24d6785673853" id="r_a8849dc20991398f6f9a24d6785673853"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; std::vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8849dc20991398f6f9a24d6785673853">output_shapes</a> (const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;inputs)</td></tr>
<tr class="memdesc:a8849dc20991398f6f9a24d6785673853"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the output shapes of the primitive.  <br /></td></tr>
<tr class="separator:a8849dc20991398f6f9a24d6785673853"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29f70eb2d3b7e6c5fe52779c03f03777" id="r_a29f70eb2d3b7e6c5fe52779c03f03777"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a29f70eb2d3b7e6c5fe52779c03f03777">~Primitive</a> ()=default</td></tr>
<tr class="separator:a29f70eb2d3b7e6c5fe52779c03f03777"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3349f745fae50ca7627f79a731a19e32" id="r_a3349f745fae50ca7627f79a731a19e32"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3349f745fae50ca7627f79a731a19e32">Primitive</a> (const <a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a> &amp;other)=delete</td></tr>
<tr class="separator:a3349f745fae50ca7627f79a731a19e32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a342da891b9882bdee9a0e0c1ac826eda" id="r_a342da891b9882bdee9a0e0c1ac826eda"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a342da891b9882bdee9a0e0c1ac826eda">Primitive</a> (<a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a> &amp;&amp;other)=delete</td></tr>
<tr class="separator:a342da891b9882bdee9a0e0c1ac826eda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b1be7ea92f3a7bb19875c70259dad6b" id="r_a6b1be7ea92f3a7bb19875c70259dad6b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b1be7ea92f3a7bb19875c70259dad6b">operator=</a> (const <a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a> &amp;other)=delete</td></tr>
<tr class="separator:a6b1be7ea92f3a7bb19875c70259dad6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50bbddd43e1ba0cf5f127cd7aa756a9e" id="r_a50bbddd43e1ba0cf5f127cd7aa756a9e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50bbddd43e1ba0cf5f127cd7aa756a9e">operator=</a> (<a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a> &amp;&amp;other)=delete</td></tr>
<tr class="separator:a50bbddd43e1ba0cf5f127cd7aa756a9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="afc69f22ee1f6e8a9ecc2c3a8f43b8fdb" name="afc69f22ee1f6e8a9ecc2c3a8f43b8fdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc69f22ee1f6e8a9ecc2c3a8f43b8fdb">&#9670;&#160;</a></span>Primitive() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mlx::core::Primitive::Primitive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmlx_1_1core_1_1_stream.html">Stream</a></td>          <td class="paramname"><span class="paramname"><em>stream</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a29f70eb2d3b7e6c5fe52779c03f03777" name="a29f70eb2d3b7e6c5fe52779c03f03777"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29f70eb2d3b7e6c5fe52779c03f03777">&#9670;&#160;</a></span>~Primitive()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual mlx::core::Primitive::~Primitive </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3349f745fae50ca7627f79a731a19e32" name="a3349f745fae50ca7627f79a731a19e32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3349f745fae50ca7627f79a731a19e32">&#9670;&#160;</a></span>Primitive() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mlx::core::Primitive::Primitive </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a342da891b9882bdee9a0e0c1ac826eda" name="a342da891b9882bdee9a0e0c1ac826eda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a342da891b9882bdee9a0e0c1ac826eda">&#9670;&#160;</a></span>Primitive() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">mlx::core::Primitive::Primitive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a> &amp;&amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8ae61e3289c4134232a69295268f8261" name="a8ae61e3289c4134232a69295268f8261"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ae61e3289c4134232a69295268f8261">&#9670;&#160;</a></span>device()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structmlx_1_1core_1_1_device.html">Device</a> &amp; mlx::core::Primitive::device </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The device the primitive will run on. </p>

</div>
</div>
<a id="a1596dc50b910538eae14878e98f07575" name="a1596dc50b910538eae14878e98f07575"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1596dc50b910538eae14878e98f07575">&#9670;&#160;</a></span>eval_cpu()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void mlx::core::Primitive::eval_cpu </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>inputs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>outputs</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A primitive must know how to evaluate itself on the CPU/GPU for the given inputs and populate the output arrays. </p>
<p>To avoid unnecessary allocations, the evaluation function is responsible for allocating space for the array. </p>

<p>Implemented in <a class="el" href="classmlx_1_1core_1_1distributed_1_1_all_reduce.html#acdc1965ad64ee9ee6328fe150a97902e">mlx::core::distributed::AllReduce</a>, <a class="el" href="classmlx_1_1core_1_1distributed_1_1_all_gather.html#ab721fe0072fffbddbc3c4334dd033ba5">mlx::core::distributed::AllGather</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_r_m_s_norm.html#a7da6e0cfd630958d9633b2e2bd97a54f">mlx::core::fast::RMSNorm</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_r_m_s_norm_v_j_p.html#adfc1d52bc266466ab29ee45fd8fab439">mlx::core::fast::RMSNormVJP</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_layer_norm.html#a5d7a4c1c9ee84e327d1c371733108c05">mlx::core::fast::LayerNorm</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_layer_norm_v_j_p.html#a0d8c4c6e7462befc38f7e08244fa1c2b">mlx::core::fast::LayerNormVJP</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_ro_p_e.html#a05a7d595c6b9dadf7ddfd6e3fd402f0e">mlx::core::fast::RoPE</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_scaled_dot_product_attention.html#ae20851e002f7fcb6d4f97817596f6328">mlx::core::fast::ScaledDotProductAttention</a>, <a class="el" href="classmlx_1_1core_1_1_unary_primitive.html#aa0ed6e32c36200a3ff9bc592c9b300db">mlx::core::UnaryPrimitive</a>, <a class="el" href="classmlx_1_1core_1_1_compiled.html#ac45b1d0fedd85feefbff7ce7e168b151">mlx::core::Compiled</a>, <a class="el" href="classmlx_1_1core_1_1_custom_transforms.html#adba1c40c77a2138df6b5f75483f62184">mlx::core::CustomTransforms</a>, <a class="el" href="classmlx_1_1core_1_1_depends.html#a0c7ea6db97337591fa53c6e6bde41e5e">mlx::core::Depends</a>, <a class="el" href="classmlx_1_1core_1_1_div_mod.html#ae350b7b93ad128e3133ee14f247193b3">mlx::core::DivMod</a>, <a class="el" href="classmlx_1_1core_1_1_split.html#aff2889cb9074f0fda53edf8fa40b1fd4">mlx::core::Split</a>, <a class="el" href="classmlx_1_1core_1_1_q_r_f.html#a48493887395d65a27f04de1804d277d2">mlx::core::QRF</a>, and <a class="el" href="classmlx_1_1core_1_1_s_v_d.html#a637f5c39fa8b10722c04a066f6c1ada6">mlx::core::SVD</a>.</p>

</div>
</div>
<a id="ad217376dcf5eff691d731566faec2ba2" name="ad217376dcf5eff691d731566faec2ba2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad217376dcf5eff691d731566faec2ba2">&#9670;&#160;</a></span>eval_gpu()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void mlx::core::Primitive::eval_gpu </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>inputs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>outputs</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classmlx_1_1core_1_1distributed_1_1_dist_primitive.html#a611ac8dfd9b4f49617ee8976ff3e15e9">mlx::core::distributed::DistPrimitive</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_r_m_s_norm.html#ae7955e8d43c097eecae264e804b4d8ca">mlx::core::fast::RMSNorm</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_r_m_s_norm_v_j_p.html#a48efb8fa84c4ba6cc9fb560ebbe01560">mlx::core::fast::RMSNormVJP</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_layer_norm.html#a77abda7f47bffa2c037a5d60cccc1528">mlx::core::fast::LayerNorm</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_layer_norm_v_j_p.html#a954a003a4a27c8c4c60a5a14142a9cc3">mlx::core::fast::LayerNormVJP</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_ro_p_e.html#a913b6b00fc518b25ac3947e4e15790f2">mlx::core::fast::RoPE</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_scaled_dot_product_attention.html#a505f38ba93a3499895f5312e0112e73d">mlx::core::fast::ScaledDotProductAttention</a>, <a class="el" href="classmlx_1_1core_1_1_unary_primitive.html#a971fe9ad47f6569118879ce1d0f41447">mlx::core::UnaryPrimitive</a>, <a class="el" href="classmlx_1_1core_1_1_compiled.html#aa3d5ff0f2b3554ad48fbbf2a0f3336d5">mlx::core::Compiled</a>, <a class="el" href="classmlx_1_1core_1_1_custom_transforms.html#a7b3538681acbb20af3ed37b0877f6667">mlx::core::CustomTransforms</a>, <a class="el" href="classmlx_1_1core_1_1_depends.html#ae5057f65e69490ad0add8eeda2b75e28">mlx::core::Depends</a>, <a class="el" href="classmlx_1_1core_1_1_div_mod.html#a003117c9ecf3c06a27248f72a76348dc">mlx::core::DivMod</a>, <a class="el" href="classmlx_1_1core_1_1_split.html#a78ddda89c4daee73c74cfbc1e44656df">mlx::core::Split</a>, <a class="el" href="classmlx_1_1core_1_1_q_r_f.html#ae5fa3482192f4713605cd07e7fc1c6c9">mlx::core::QRF</a>, and <a class="el" href="classmlx_1_1core_1_1_s_v_d.html#a7067b2207f826a25549d571856b94e83">mlx::core::SVD</a>.</p>

</div>
</div>
<a id="a6140a502af4c2bbbc776ab26e9afebcd" name="a6140a502af4c2bbbc776ab26e9afebcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6140a502af4c2bbbc776ab26e9afebcd">&#9670;&#160;</a></span>is_equivalent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool mlx::core::Primitive::is_equivalent </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Equivalence check defaults to false unless overridden by the primitive. </p>

<p>Reimplemented in <a class="el" href="classmlx_1_1core_1_1fast_1_1_scaled_dot_product_attention.html#af08b1294f3f93505a96fdfa85b1edd62">mlx::core::fast::ScaledDotProductAttention</a>, <a class="el" href="classmlx_1_1core_1_1_abs.html#ab6f0ec56bc7c048382297e12dabadc67">mlx::core::Abs</a>, <a class="el" href="classmlx_1_1core_1_1_add.html#aba0a35410c3aac53d0f7a0c283d9ee3f">mlx::core::Add</a>, <a class="el" href="classmlx_1_1core_1_1_add_m_m.html#a6e37c6882dba995a63fb6d8dfb01754f">mlx::core::AddMM</a>, <a class="el" href="classmlx_1_1core_1_1_arange.html#a7b6a45cf9c4b109d4e0373f3fe576c35">mlx::core::Arange</a>, <a class="el" href="classmlx_1_1core_1_1_arc_cos.html#a39557461e3235801886675a9b7d25bf5">mlx::core::ArcCos</a>, <a class="el" href="classmlx_1_1core_1_1_arc_cosh.html#a6928e827b9ac2e86e7d5b02b78150eee">mlx::core::ArcCosh</a>, <a class="el" href="classmlx_1_1core_1_1_arc_sin.html#a13b5e39eeccaf32d94b8eb85b3b753ab">mlx::core::ArcSin</a>, <a class="el" href="classmlx_1_1core_1_1_arc_sinh.html#a63c7a765c7906242dc3371deec094f0f">mlx::core::ArcSinh</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tan.html#a0e5b5fc7218143ecd0a8666d9137c34c">mlx::core::ArcTan</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tan2.html#aeaee58cd803d3ebf0b76574a409682cc">mlx::core::ArcTan2</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tanh.html#ac8ecdd640043dab0461d49d7650679a2">mlx::core::ArcTanh</a>, <a class="el" href="classmlx_1_1core_1_1_arg_partition.html#ad87509ce70b51fb75dfb9c3a05a5b31a">mlx::core::ArgPartition</a>, <a class="el" href="classmlx_1_1core_1_1_arg_reduce.html#a03b81a670dcb1e39bf7279e4d4583b97">mlx::core::ArgReduce</a>, <a class="el" href="classmlx_1_1core_1_1_arg_sort.html#a048cd09c557d29d1111726f97010a845">mlx::core::ArgSort</a>, <a class="el" href="classmlx_1_1core_1_1_as_type.html#a8e6c8b2428ab15c4fb43f2e3a8fb38af">mlx::core::AsType</a>, <a class="el" href="classmlx_1_1core_1_1_as_strided.html#a1738c6aa0a3a3eb68530f0d5b436e094">mlx::core::AsStrided</a>, <a class="el" href="classmlx_1_1core_1_1_bitwise_binary.html#a8cd6b916b4838a6c329cf4df8530c3b8">mlx::core::BitwiseBinary</a>, <a class="el" href="classmlx_1_1core_1_1_block_masked_m_m.html#aef1c303955f9b8f445296372cf181160">mlx::core::BlockMaskedMM</a>, <a class="el" href="classmlx_1_1core_1_1_gather_m_m.html#a163f17f6ce2c002f22e81b302777342b">mlx::core::GatherMM</a>, <a class="el" href="classmlx_1_1core_1_1_broadcast.html#a0e27692b0090ec451954649a36042616">mlx::core::Broadcast</a>, <a class="el" href="classmlx_1_1core_1_1_ceil.html#aacd90acb56eb0649c1cef807aa21df52">mlx::core::Ceil</a>, <a class="el" href="classmlx_1_1core_1_1_compiled.html#a63e5016458887813b4a59dee5a0a3f10">mlx::core::Compiled</a>, <a class="el" href="classmlx_1_1core_1_1_concatenate.html#aaf8a72a0c30114460caf519580cc35d2">mlx::core::Concatenate</a>, <a class="el" href="classmlx_1_1core_1_1_conjugate.html#af42f00a790c6bc5572bd8fe9e5b36c5e">mlx::core::Conjugate</a>, <a class="el" href="classmlx_1_1core_1_1_convolution.html#afb87708a5e3aab2e9e663daa9d8863de">mlx::core::Convolution</a>, <a class="el" href="classmlx_1_1core_1_1_copy.html#afcfa39465015f638e294aa954ea0f3da">mlx::core::Copy</a>, <a class="el" href="classmlx_1_1core_1_1_cos.html#ab611ca38c987915659f7ffcce0370417">mlx::core::Cos</a>, <a class="el" href="classmlx_1_1core_1_1_cosh.html#ae0bacccaf501f5349db0c13cca776ff9">mlx::core::Cosh</a>, <a class="el" href="classmlx_1_1core_1_1_divide.html#a3dda091f05c4164c29bb8129e9712650">mlx::core::Divide</a>, <a class="el" href="classmlx_1_1core_1_1_div_mod.html#af5fcf8ec8515d46844cbeeab6dafb38a">mlx::core::DivMod</a>, <a class="el" href="classmlx_1_1core_1_1_select.html#afc3c333fac7f902c98839921ef2874c8">mlx::core::Select</a>, <a class="el" href="classmlx_1_1core_1_1_remainder.html#a802039faaa2ed7b763ec3d7debcce814">mlx::core::Remainder</a>, <a class="el" href="classmlx_1_1core_1_1_equal.html#a58c1c5003e43f47dc0788c1851deaa02">mlx::core::Equal</a>, <a class="el" href="classmlx_1_1core_1_1_erf.html#abe99dfbc2954c3a7d5dec56ab165ee82">mlx::core::Erf</a>, <a class="el" href="classmlx_1_1core_1_1_erf_inv.html#aaac9e3b454ba564f9c6e804ab6562832">mlx::core::ErfInv</a>, <a class="el" href="classmlx_1_1core_1_1_exp.html#ac6e44bffe7a643ab4ca51e74c7328357">mlx::core::Exp</a>, <a class="el" href="classmlx_1_1core_1_1_f_f_t.html#a0ede3bc8b6d77d560c0a750b68fddc06">mlx::core::FFT</a>, <a class="el" href="classmlx_1_1core_1_1_floor.html#a24b64feb026c4fcd02fc481cffdb1c94">mlx::core::Floor</a>, <a class="el" href="classmlx_1_1core_1_1_full.html#afafcbcae1e28597fe8f7fde289105792">mlx::core::Full</a>, <a class="el" href="classmlx_1_1core_1_1_gather.html#a23ff1406dbf0c770e75ad47440b467aa">mlx::core::Gather</a>, <a class="el" href="classmlx_1_1core_1_1_greater.html#a6877a6888614a618dc64296763ccabb1">mlx::core::Greater</a>, <a class="el" href="classmlx_1_1core_1_1_greater_equal.html#a3daef8596b963026b602019bc56fc5fc">mlx::core::GreaterEqual</a>, <a class="el" href="classmlx_1_1core_1_1_hadamard.html#a8a528d8d69a7343bdfd704a3e74230b8">mlx::core::Hadamard</a>, <a class="el" href="classmlx_1_1core_1_1_less.html#a7d6ed6353a0dcefebd008026dbd3cd63">mlx::core::Less</a>, <a class="el" href="classmlx_1_1core_1_1_less_equal.html#a76ee1438cf4bd109eae4e0b3472b26af">mlx::core::LessEqual</a>, <a class="el" href="classmlx_1_1core_1_1_log.html#a2fc58ea4ca744db493b947d1136d05f8">mlx::core::Log</a>, <a class="el" href="classmlx_1_1core_1_1_logical_not.html#aba53675da351cd9b71a73d475b4bbe99">mlx::core::LogicalNot</a>, <a class="el" href="classmlx_1_1core_1_1_logical_and.html#a9572c35f72e0db2f7f86bbf42438a6be">mlx::core::LogicalAnd</a>, <a class="el" href="classmlx_1_1core_1_1_logical_or.html#a9c8b10a5cf5c69fdc2362390197e4e71">mlx::core::LogicalOr</a>, <a class="el" href="classmlx_1_1core_1_1_log_add_exp.html#a3cf9a202c05aff39919d713d6e2b32e4">mlx::core::LogAddExp</a>, <a class="el" href="classmlx_1_1core_1_1_matmul.html#aab372b59eae0840fc4f75ef5719a2630">mlx::core::Matmul</a>, <a class="el" href="classmlx_1_1core_1_1_maximum.html#a21fe93fbd7799682f481260aee8bdb46">mlx::core::Maximum</a>, <a class="el" href="classmlx_1_1core_1_1_minimum.html#a56c54ee3293cc2cd84462b9ec7ac36b4">mlx::core::Minimum</a>, <a class="el" href="classmlx_1_1core_1_1_multiply.html#ae288159fa2d6d35087a85aca8eafa9b2">mlx::core::Multiply</a>, <a class="el" href="classmlx_1_1core_1_1_negative.html#ac2a4d8159c548639d6289980c8975823">mlx::core::Negative</a>, <a class="el" href="classmlx_1_1core_1_1_not_equal.html#ac12fd6b3e2f2e7e4e622b59badf2c73d">mlx::core::NotEqual</a>, <a class="el" href="classmlx_1_1core_1_1_number_of_elements.html#ad6a32565ccc64499e368e15bba0b438f">mlx::core::NumberOfElements</a>, <a class="el" href="classmlx_1_1core_1_1_pad.html#aad7c3bfecafe435d6a8e807de4c7ea9b">mlx::core::Pad</a>, <a class="el" href="classmlx_1_1core_1_1_partition.html#aabdf6ef4f2159b2bfe93e0e87d4772f8">mlx::core::Partition</a>, <a class="el" href="classmlx_1_1core_1_1_power.html#a76b4ec9d1ff07f06189e414480453d68">mlx::core::Power</a>, <a class="el" href="classmlx_1_1core_1_1_quantized_matmul.html#af28b36e3f40ea41785387800326cc8e1">mlx::core::QuantizedMatmul</a>, <a class="el" href="classmlx_1_1core_1_1_gather_q_m_m.html#a6a7da6bcf657fcdb157c45bf35fdec11">mlx::core::GatherQMM</a>, <a class="el" href="classmlx_1_1core_1_1_random_bits.html#a72ec915debf5823e7c0463045b2894e6">mlx::core::RandomBits</a>, <a class="el" href="classmlx_1_1core_1_1_reshape.html#abd07c53af476777a04307e0423784cf3">mlx::core::Reshape</a>, <a class="el" href="classmlx_1_1core_1_1_reduce.html#abe8f3327d617d0dd7438f066497ae08e">mlx::core::Reduce</a>, <a class="el" href="classmlx_1_1core_1_1_round.html#aeb3d8607bbba7345a3142d4cbd4e6927">mlx::core::Round</a>, <a class="el" href="classmlx_1_1core_1_1_scan.html#a54445a4d677ca4fe2a58d08eb5223ac6">mlx::core::Scan</a>, <a class="el" href="classmlx_1_1core_1_1_scatter.html#a0208172562abdc90472e6eb5f84c987f">mlx::core::Scatter</a>, <a class="el" href="classmlx_1_1core_1_1_sigmoid.html#a04814ba1b0edf8299d5ca1bcb8749d8e">mlx::core::Sigmoid</a>, <a class="el" href="classmlx_1_1core_1_1_sign.html#a8c0934acbcc4b146e5aacd35a8c445bb">mlx::core::Sign</a>, <a class="el" href="classmlx_1_1core_1_1_sin.html#af00b0e5516f884996ce7a97e6c1e3e6a">mlx::core::Sin</a>, <a class="el" href="classmlx_1_1core_1_1_sinh.html#adcb1878996fd4902cd550042dd6ad70d">mlx::core::Sinh</a>, <a class="el" href="classmlx_1_1core_1_1_slice.html#a43202c3b8966ae1db9ab82072e4918b0">mlx::core::Slice</a>, <a class="el" href="classmlx_1_1core_1_1_slice_update.html#a60f588acced42391e6e5615ae8d16119">mlx::core::SliceUpdate</a>, <a class="el" href="classmlx_1_1core_1_1_softmax.html#a9215ed7bd36bc11276c58dfb9808d728">mlx::core::Softmax</a>, <a class="el" href="classmlx_1_1core_1_1_sort.html#ae48f07cf641d54234fc4fb6529a33511">mlx::core::Sort</a>, <a class="el" href="classmlx_1_1core_1_1_split.html#af25a0cc259573b9dce60d285eee18345">mlx::core::Split</a>, <a class="el" href="classmlx_1_1core_1_1_square.html#a6abc881d44071019aa15481e5ea75ab2">mlx::core::Square</a>, <a class="el" href="classmlx_1_1core_1_1_sqrt.html#ab871c2b8ab4a27a3f782a005d0e87c46">mlx::core::Sqrt</a>, <a class="el" href="classmlx_1_1core_1_1_stop_gradient.html#a327539298b21d800d26482b94fce41b3">mlx::core::StopGradient</a>, <a class="el" href="classmlx_1_1core_1_1_subtract.html#af1c05e1e3f703ba916d54f8ccbbd102b">mlx::core::Subtract</a>, <a class="el" href="classmlx_1_1core_1_1_tan.html#afdf46288e7f60ea7f878688347dff7e4">mlx::core::Tan</a>, <a class="el" href="classmlx_1_1core_1_1_tanh.html#a0692a1de2373b86eb394252ed4fecfda">mlx::core::Tanh</a>, <a class="el" href="classmlx_1_1core_1_1_uniform.html#abb6048807a7c5b2e35a77e06a17f801b">mlx::core::Uniform</a>, <a class="el" href="classmlx_1_1core_1_1_view.html#a7cb8403a96a47cb258caac4e3b850f64">mlx::core::View</a>, and <a class="el" href="classmlx_1_1core_1_1_transpose.html#a799ec3c3fa9f1b9e6177c755252a3eab">mlx::core::Transpose</a>.</p>

</div>
</div>
<a id="a9fecf38f53da08ba1947543c2b3158c2" name="a9fecf38f53da08ba1947543c2b3158c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fecf38f53da08ba1947543c2b3158c2">&#9670;&#160;</a></span>jvp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; mlx::core::Primitive::jvp </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>primals</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>tangents</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>argnums</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The Jacobian-vector product. </p>

<p>Reimplemented in <a class="el" href="classmlx_1_1core_1_1distributed_1_1_all_reduce.html#aeaf6f2b5955e7417cd1e36db42c45a80">mlx::core::distributed::AllReduce</a>, <a class="el" href="classmlx_1_1core_1_1distributed_1_1_all_gather.html#a96f08a4ea8453d0b4b737c7b07972913">mlx::core::distributed::AllGather</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_custom.html#ac77b28702654df8e7d882a49357a9584">mlx::core::fast::Custom</a>, <a class="el" href="classmlx_1_1core_1_1_abs.html#a6c1e6eeaf4f5e63898c3487106e88e11">mlx::core::Abs</a>, <a class="el" href="classmlx_1_1core_1_1_add.html#a77230069f76fe60a2fe1007822a277b7">mlx::core::Add</a>, <a class="el" href="classmlx_1_1core_1_1_arc_cos.html#a240079c616f1a1f127aa783308096fe9">mlx::core::ArcCos</a>, <a class="el" href="classmlx_1_1core_1_1_arc_cosh.html#a80fcb790649219c30260af903b76a1d7">mlx::core::ArcCosh</a>, <a class="el" href="classmlx_1_1core_1_1_arc_sin.html#a37affc8c5e84e5c54e73a71fc0821ea4">mlx::core::ArcSin</a>, <a class="el" href="classmlx_1_1core_1_1_arc_sinh.html#a79ebf2f6dfecbfbb93170fdd1ca87bf4">mlx::core::ArcSinh</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tan.html#a0f5590a2297fc133b4b0a15f9dd0c760">mlx::core::ArcTan</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tan2.html#a01675433f2a4fa466b2f48272dbca738">mlx::core::ArcTan2</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tanh.html#a534ebdbfe77241884630d25021274c4a">mlx::core::ArcTanh</a>, <a class="el" href="classmlx_1_1core_1_1_as_type.html#a213400967150c57da35795e1c9f65ca0">mlx::core::AsType</a>, <a class="el" href="classmlx_1_1core_1_1_as_strided.html#a8ff0a398c47b42e08bc1122e07a02b53">mlx::core::AsStrided</a>, <a class="el" href="classmlx_1_1core_1_1_bitwise_binary.html#a1dae6ce5dc0498d20530403fe5c5531d">mlx::core::BitwiseBinary</a>, <a class="el" href="classmlx_1_1core_1_1_broadcast.html#ae2fc3851a117079244708864be770ece">mlx::core::Broadcast</a>, <a class="el" href="classmlx_1_1core_1_1_ceil.html#a7ad74b27d9f26c886c2af516b845f066">mlx::core::Ceil</a>, <a class="el" href="classmlx_1_1core_1_1_compiled.html#aa385fe28626856ca5f57161b47a3c205">mlx::core::Compiled</a>, <a class="el" href="classmlx_1_1core_1_1_concatenate.html#a9f9e7a9dc3a00e02b84c94e1868baff1">mlx::core::Concatenate</a>, <a class="el" href="classmlx_1_1core_1_1_copy.html#a5acf02aa360cbefd86749fe9877b29cc">mlx::core::Copy</a>, <a class="el" href="classmlx_1_1core_1_1_cos.html#a99dd0b7e4aa2c838b77736f1fd539ee1">mlx::core::Cos</a>, <a class="el" href="classmlx_1_1core_1_1_cosh.html#a79facb0882443533f36a0a18407f5863">mlx::core::Cosh</a>, <a class="el" href="classmlx_1_1core_1_1_custom_transforms.html#aa9f695100170d5cae999b3da138ce720">mlx::core::CustomTransforms</a>, <a class="el" href="classmlx_1_1core_1_1_divide.html#ae1f408c447b17b3c84fe7f951d95559c">mlx::core::Divide</a>, <a class="el" href="classmlx_1_1core_1_1_div_mod.html#a1267401f25f25847888dd0a00b3fe3b9">mlx::core::DivMod</a>, <a class="el" href="classmlx_1_1core_1_1_select.html#a172df6812c2ea3e9d3c3fc5d527548d6">mlx::core::Select</a>, <a class="el" href="classmlx_1_1core_1_1_remainder.html#a972002173fc00ee86029d12bf1a9ba79">mlx::core::Remainder</a>, <a class="el" href="classmlx_1_1core_1_1_equal.html#a659d484589d7cd96d038922a1a98730f">mlx::core::Equal</a>, <a class="el" href="classmlx_1_1core_1_1_erf.html#ac733d605d80277d613954794eb8c46fe">mlx::core::Erf</a>, <a class="el" href="classmlx_1_1core_1_1_erf_inv.html#aa52710297ab6f7cd6826418c303e64be">mlx::core::ErfInv</a>, <a class="el" href="classmlx_1_1core_1_1_exp.html#aef6721832fcc283b082e35a7d436fa59">mlx::core::Exp</a>, <a class="el" href="classmlx_1_1core_1_1_expm1.html#ad463730632a00945d3a8addfdaec67b1">mlx::core::Expm1</a>, <a class="el" href="classmlx_1_1core_1_1_f_f_t.html#a34578814b6576f7b7b447541984ecba6">mlx::core::FFT</a>, <a class="el" href="classmlx_1_1core_1_1_floor.html#aa47bc360ec563b6e7d93e8b50626d8af">mlx::core::Floor</a>, <a class="el" href="classmlx_1_1core_1_1_full.html#a281a865d0664596ac8d05ea8e7f26407">mlx::core::Full</a>, <a class="el" href="classmlx_1_1core_1_1_gather.html#ac54ef8fac92ab190f1793f3dd95b9e8d">mlx::core::Gather</a>, <a class="el" href="classmlx_1_1core_1_1_greater.html#aa47a9f80f45daf6a405e34f6dc7c99c1">mlx::core::Greater</a>, <a class="el" href="classmlx_1_1core_1_1_greater_equal.html#ac7346080aaaa01d52896127f383f9d20">mlx::core::GreaterEqual</a>, <a class="el" href="classmlx_1_1core_1_1_hadamard.html#a22b9d55ae3ba5eef63505124696e712a">mlx::core::Hadamard</a>, <a class="el" href="classmlx_1_1core_1_1_less.html#af1493d566f6d940b8f674aac17f5dfce">mlx::core::Less</a>, <a class="el" href="classmlx_1_1core_1_1_less_equal.html#addfe62d3557d216f8307bdf1cbff6a8f">mlx::core::LessEqual</a>, <a class="el" href="classmlx_1_1core_1_1_log.html#ac646d4155322c34f58183d97301e3832">mlx::core::Log</a>, <a class="el" href="classmlx_1_1core_1_1_log1p.html#a537e44c7c993daf48698082e75e71ba2">mlx::core::Log1p</a>, <a class="el" href="classmlx_1_1core_1_1_logical_not.html#a4838c483ced707cfda3d6cd24bf4667c">mlx::core::LogicalNot</a>, <a class="el" href="classmlx_1_1core_1_1_logical_and.html#a78d3be71da224ea19158cf9e8c4cf434">mlx::core::LogicalAnd</a>, <a class="el" href="classmlx_1_1core_1_1_logical_or.html#a292de6001c551214c8152a7a5b0e6bd4">mlx::core::LogicalOr</a>, <a class="el" href="classmlx_1_1core_1_1_log_add_exp.html#aea2d1d58794e86f3488219ed3fa14329">mlx::core::LogAddExp</a>, <a class="el" href="classmlx_1_1core_1_1_maximum.html#a25ac5d5b453e571bf7240aa8de103c39">mlx::core::Maximum</a>, <a class="el" href="classmlx_1_1core_1_1_minimum.html#a10acf4fef35eed7ca55d131b5ae2d038">mlx::core::Minimum</a>, <a class="el" href="classmlx_1_1core_1_1_multiply.html#a79f7f0bb70de2e3e41a66c96285325b4">mlx::core::Multiply</a>, <a class="el" href="classmlx_1_1core_1_1_negative.html#a7d918f9b26b8fb7b047a27d85ebab979">mlx::core::Negative</a>, <a class="el" href="classmlx_1_1core_1_1_not_equal.html#ae2d3e5776efaefed7f4c73f679b02f17">mlx::core::NotEqual</a>, <a class="el" href="classmlx_1_1core_1_1_pad.html#a6e43a42032ef11497e8d91290574ec72">mlx::core::Pad</a>, <a class="el" href="classmlx_1_1core_1_1_partition.html#a310f569a163958940ed02cf52079746a">mlx::core::Partition</a>, <a class="el" href="classmlx_1_1core_1_1_power.html#a3e78b06453faa4fd149fd19c0e7a300a">mlx::core::Power</a>, <a class="el" href="classmlx_1_1core_1_1_quantized_matmul.html#ae51fdd0b81dd26c6687577567c126e23">mlx::core::QuantizedMatmul</a>, <a class="el" href="classmlx_1_1core_1_1_gather_q_m_m.html#adc579058752b927c71b45a962d4869e0">mlx::core::GatherQMM</a>, <a class="el" href="classmlx_1_1core_1_1_reshape.html#ab8fc28748991017cc3e29f93c91087a5">mlx::core::Reshape</a>, <a class="el" href="classmlx_1_1core_1_1_round.html#a032075a7d0dde2dba6189636d216c5e7">mlx::core::Round</a>, <a class="el" href="classmlx_1_1core_1_1_scan.html#a6f9c862f4fbc7eaf430a361cdd8933ee">mlx::core::Scan</a>, <a class="el" href="classmlx_1_1core_1_1_scatter.html#a270fa8ccf36ce4bbbc23875139223934">mlx::core::Scatter</a>, <a class="el" href="classmlx_1_1core_1_1_sigmoid.html#a62ca1c440896e32958c77af3340847db">mlx::core::Sigmoid</a>, <a class="el" href="classmlx_1_1core_1_1_sign.html#a957992c7aa0e86cf06f861a94372086b">mlx::core::Sign</a>, <a class="el" href="classmlx_1_1core_1_1_sin.html#af662d10180967399820496477ff050de">mlx::core::Sin</a>, <a class="el" href="classmlx_1_1core_1_1_sinh.html#a86e2b37823daf20a4c74c9f273215f9c">mlx::core::Sinh</a>, <a class="el" href="classmlx_1_1core_1_1_slice.html#a8288324045ab21d6c97b1695ce86ef36">mlx::core::Slice</a>, <a class="el" href="classmlx_1_1core_1_1_slice_update.html#a0ce3248cc61dae2b51d7aa8ee4197611">mlx::core::SliceUpdate</a>, <a class="el" href="classmlx_1_1core_1_1_softmax.html#af96172634a24332b0fc8d7ca7e73f19f">mlx::core::Softmax</a>, <a class="el" href="classmlx_1_1core_1_1_sort.html#af113ac983473433eec851c8fddfcba62">mlx::core::Sort</a>, <a class="el" href="classmlx_1_1core_1_1_split.html#ab8a8d30fd1ebf0891f41f3c32eabe282">mlx::core::Split</a>, <a class="el" href="classmlx_1_1core_1_1_square.html#a822629b93b91e2bef29959431d95e22d">mlx::core::Square</a>, <a class="el" href="classmlx_1_1core_1_1_sqrt.html#a78544b1fb5da0c14bce3051ffd177818">mlx::core::Sqrt</a>, <a class="el" href="classmlx_1_1core_1_1_subtract.html#a8100081a99df5166f02efc76d6641220">mlx::core::Subtract</a>, <a class="el" href="classmlx_1_1core_1_1_tan.html#a5d7c76122d63619df17b0e45450bc8f2">mlx::core::Tan</a>, <a class="el" href="classmlx_1_1core_1_1_tanh.html#ae0fbb5370dc1c3a4fb0dd02ca28a832a">mlx::core::Tanh</a>, and <a class="el" href="classmlx_1_1core_1_1_transpose.html#ac1a523e25ab7fd9df4da363a922afbe1">mlx::core::Transpose</a>.</p>

</div>
</div>
<a id="a6b1be7ea92f3a7bb19875c70259dad6b" name="a6b1be7ea92f3a7bb19875c70259dad6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b1be7ea92f3a7bb19875c70259dad6b">&#9670;&#160;</a></span>operator=() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a> &amp; mlx::core::Primitive::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a50bbddd43e1ba0cf5f127cd7aa756a9e" name="a50bbddd43e1ba0cf5f127cd7aa756a9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50bbddd43e1ba0cf5f127cd7aa756a9e">&#9670;&#160;</a></span>operator=() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a> &amp; mlx::core::Primitive::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classmlx_1_1core_1_1_primitive.html">Primitive</a> &amp;&amp;</td>          <td class="paramname"><span class="paramname"><em>other</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a8849dc20991398f6f9a24d6785673853" name="a8849dc20991398f6f9a24d6785673853"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8849dc20991398f6f9a24d6785673853">&#9670;&#160;</a></span>output_shapes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt; std::vector&lt; int &gt; &gt; mlx::core::Primitive::output_shapes </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>inputs</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the output shapes of the primitive. </p>
<p>This is not required to be implemented by derived classes, in which case it will throw. </p>

<p>Reimplemented in <a class="el" href="classmlx_1_1core_1_1_abs.html#ab6a2b147f58c83439ecefb9189c2da32">mlx::core::Abs</a>, <a class="el" href="classmlx_1_1core_1_1_add.html#a9884fece6ca4061a65241c985fcf1594">mlx::core::Add</a>, <a class="el" href="classmlx_1_1core_1_1_arc_cos.html#a8ecd5b9a8cc9cba841768a5b2b497974">mlx::core::ArcCos</a>, <a class="el" href="classmlx_1_1core_1_1_arc_cosh.html#ae5d6660121f7f5a55824b95e7fd3dc6b">mlx::core::ArcCosh</a>, <a class="el" href="classmlx_1_1core_1_1_arc_sin.html#a1c6e478804eb5d171e4859b872db29f5">mlx::core::ArcSin</a>, <a class="el" href="classmlx_1_1core_1_1_arc_sinh.html#a6e0319a3cee5f6b9d43a3ac256b2c2ed">mlx::core::ArcSinh</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tan.html#aa5d1e60d50ffa77b1d0e14af8d7e127a">mlx::core::ArcTan</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tan2.html#a3f4ad806a0c59c2d1ae1c55c9889bf03">mlx::core::ArcTan2</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tanh.html#a30246c56e1d75638c3696f84323861d8">mlx::core::ArcTanh</a>, <a class="el" href="classmlx_1_1core_1_1_arg_partition.html#a28608aee76a2db25f6455da561526c64">mlx::core::ArgPartition</a>, <a class="el" href="classmlx_1_1core_1_1_arg_reduce.html#a40a047cb3ed8d1445d42100b3fd85179">mlx::core::ArgReduce</a>, <a class="el" href="classmlx_1_1core_1_1_arg_sort.html#ac50e0b76c457aae944425b3a57c33859">mlx::core::ArgSort</a>, <a class="el" href="classmlx_1_1core_1_1_as_type.html#a18922e68006b5cf005355f5c9ac57ac4">mlx::core::AsType</a>, <a class="el" href="classmlx_1_1core_1_1_bitwise_binary.html#a7d2dfa8884832fc1a94ce6400d0ed599">mlx::core::BitwiseBinary</a>, <a class="el" href="classmlx_1_1core_1_1_ceil.html#a1eb263c04df810e212855a17af0658ea">mlx::core::Ceil</a>, <a class="el" href="classmlx_1_1core_1_1_compiled.html#a453a10c68b7825def5b53207bc04a71c">mlx::core::Compiled</a>, <a class="el" href="classmlx_1_1core_1_1_conjugate.html#ada40413e9f210251476a37cc0d0ea37f">mlx::core::Conjugate</a>, <a class="el" href="classmlx_1_1core_1_1_copy.html#ac3d13ebc6464403962fa1a9897fe6df3">mlx::core::Copy</a>, <a class="el" href="classmlx_1_1core_1_1_cos.html#a05b2d43942aa1d93a40c20ae8b90a25b">mlx::core::Cos</a>, <a class="el" href="classmlx_1_1core_1_1_cosh.html#a1bef7feac9a387ea80e7fc774f579962">mlx::core::Cosh</a>, <a class="el" href="classmlx_1_1core_1_1_divide.html#ad514bed77ad94742e26c93e446940994">mlx::core::Divide</a>, <a class="el" href="classmlx_1_1core_1_1_div_mod.html#a61d835d777c8063089dc708898ff314b">mlx::core::DivMod</a>, <a class="el" href="classmlx_1_1core_1_1_select.html#a295cd22e2284f2216bc93fdcf0b54867">mlx::core::Select</a>, <a class="el" href="classmlx_1_1core_1_1_remainder.html#a74bf3a9723b59200573ff8bac9a0b666">mlx::core::Remainder</a>, <a class="el" href="classmlx_1_1core_1_1_equal.html#a2f91e9603f63ad539837356b1ff3e7a9">mlx::core::Equal</a>, <a class="el" href="classmlx_1_1core_1_1_erf.html#afa4abbd7786b474c44c336a95481d187">mlx::core::Erf</a>, <a class="el" href="classmlx_1_1core_1_1_erf_inv.html#a22a95594e68b43b50c05355c82779639">mlx::core::ErfInv</a>, <a class="el" href="classmlx_1_1core_1_1_exp.html#aee7ba8d5be4a11f4b8f359b0338ab670">mlx::core::Exp</a>, <a class="el" href="classmlx_1_1core_1_1_expm1.html#ab9dbf34806eb43b928722ed9e8feed08">mlx::core::Expm1</a>, <a class="el" href="classmlx_1_1core_1_1_floor.html#aaf86becc7bfba6ee2af0d1f6d8e25015">mlx::core::Floor</a>, <a class="el" href="classmlx_1_1core_1_1_greater.html#ab2167a38c3baff99f527f17eb4c71d46">mlx::core::Greater</a>, <a class="el" href="classmlx_1_1core_1_1_greater_equal.html#a636a9cc00b0333e49978f39814af640f">mlx::core::GreaterEqual</a>, <a class="el" href="classmlx_1_1core_1_1_hadamard.html#a458614bc7820ae56493eb56d813b2cde">mlx::core::Hadamard</a>, <a class="el" href="classmlx_1_1core_1_1_less.html#a5e8b56574ccb91c065548f4bda40e278">mlx::core::Less</a>, <a class="el" href="classmlx_1_1core_1_1_less_equal.html#a2e259f3de11f97f3bd38a2e65667d78f">mlx::core::LessEqual</a>, <a class="el" href="classmlx_1_1core_1_1_log.html#a113dcc95e2a1a052238b1f5c8935a63d">mlx::core::Log</a>, <a class="el" href="classmlx_1_1core_1_1_log1p.html#aebf8f5b6670f55fa24283a934f4b25df">mlx::core::Log1p</a>, <a class="el" href="classmlx_1_1core_1_1_logical_not.html#a4a40511a052a6627085be378bbebe69c">mlx::core::LogicalNot</a>, <a class="el" href="classmlx_1_1core_1_1_logical_and.html#a191d69d92c01ed5ad82d4688f1de2617">mlx::core::LogicalAnd</a>, <a class="el" href="classmlx_1_1core_1_1_logical_or.html#a26259843be2de75d5e07cb7ea94fcfe4">mlx::core::LogicalOr</a>, <a class="el" href="classmlx_1_1core_1_1_log_add_exp.html#ac35cf432ecdd141d957b55fc4bff6635">mlx::core::LogAddExp</a>, <a class="el" href="classmlx_1_1core_1_1_maximum.html#a7bb80360ba4b74d0b0f3f74a5ff90d1b">mlx::core::Maximum</a>, <a class="el" href="classmlx_1_1core_1_1_minimum.html#ab4a85741dffaa64d8ead028f11539d70">mlx::core::Minimum</a>, <a class="el" href="classmlx_1_1core_1_1_multiply.html#a072de3911113247c95c28d3b52400061">mlx::core::Multiply</a>, <a class="el" href="classmlx_1_1core_1_1_negative.html#a253c08c7461bf2dce05f555c8dbf0014">mlx::core::Negative</a>, <a class="el" href="classmlx_1_1core_1_1_not_equal.html#a5b10e99bc564197e7b16dccb0577d89a">mlx::core::NotEqual</a>, <a class="el" href="classmlx_1_1core_1_1_number_of_elements.html#aae36bb1e125c0a2d7cd54e78be0f2af8">mlx::core::NumberOfElements</a>, <a class="el" href="classmlx_1_1core_1_1_partition.html#ae5b792df683bc14dde89f75ac6bcbeaf">mlx::core::Partition</a>, <a class="el" href="classmlx_1_1core_1_1_power.html#a1c17867ea1bad8899adb38185c9423c1">mlx::core::Power</a>, <a class="el" href="classmlx_1_1core_1_1_reduce.html#a0f73c2a55dc324145e11020c9b4d9a65">mlx::core::Reduce</a>, <a class="el" href="classmlx_1_1core_1_1_round.html#ad9a26817864dfc94b56e66bc6d80b047">mlx::core::Round</a>, <a class="el" href="classmlx_1_1core_1_1_sigmoid.html#a34572023c8748971289c2cb109ff9a43">mlx::core::Sigmoid</a>, <a class="el" href="classmlx_1_1core_1_1_sign.html#a719709b3c5d6b15a75614bdadd185f67">mlx::core::Sign</a>, <a class="el" href="classmlx_1_1core_1_1_sin.html#a46f059f04fd540f175f6031d28dc9f3a">mlx::core::Sin</a>, <a class="el" href="classmlx_1_1core_1_1_sinh.html#a4f10e7e6daf500575d97e077901e7d28">mlx::core::Sinh</a>, <a class="el" href="classmlx_1_1core_1_1_softmax.html#afea757ba328b9d8f35058793eae73e35">mlx::core::Softmax</a>, <a class="el" href="classmlx_1_1core_1_1_sort.html#a271545b66607b22e5f06a0fefe69f22d">mlx::core::Sort</a>, <a class="el" href="classmlx_1_1core_1_1_square.html#ac4c4927639cab1c5b91a074e7f68da02">mlx::core::Square</a>, <a class="el" href="classmlx_1_1core_1_1_sqrt.html#ae3d4f99729a7e72be7decf5a56d095d5">mlx::core::Sqrt</a>, <a class="el" href="classmlx_1_1core_1_1_stop_gradient.html#a12e7f55e087aea58b2a56f239c69bb4e">mlx::core::StopGradient</a>, <a class="el" href="classmlx_1_1core_1_1_subtract.html#a0fbf4bc9a0c76edc37ebb4083d98f3fc">mlx::core::Subtract</a>, <a class="el" href="classmlx_1_1core_1_1_tan.html#a7be9fd77491a48b07b6e126ab68bdf37">mlx::core::Tan</a>, and <a class="el" href="classmlx_1_1core_1_1_tanh.html#a0392f51a9e51915d4691615757ba4325">mlx::core::Tanh</a>.</p>

</div>
</div>
<a id="ae1aff91354ce036596088a3e19474ecb" name="ae1aff91354ce036596088a3e19474ecb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1aff91354ce036596088a3e19474ecb">&#9670;&#160;</a></span>print()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void mlx::core::Primitive::print </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;</td>          <td class="paramname"><span class="paramname"><em>os</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Print the primitive. </p>

<p>Implemented in <a class="el" href="classmlx_1_1core_1_1distributed_1_1_all_reduce.html#a6814f9008a683c6911d5b8991ef770ab">mlx::core::distributed::AllReduce</a>, <a class="el" href="classmlx_1_1core_1_1_abs.html#a643d6db5116eed978e3208804a992107">mlx::core::Abs</a>, <a class="el" href="classmlx_1_1core_1_1_add.html#a8a96345aa63724f22b68bca7b861211d">mlx::core::Add</a>, <a class="el" href="classmlx_1_1core_1_1_add_m_m.html#a1262ac2c4c6e9ff6b6047bf7605e5cc9">mlx::core::AddMM</a>, <a class="el" href="classmlx_1_1core_1_1_arange.html#abd73d2b793da796dc7cf04c9f7d5c19e">mlx::core::Arange</a>, <a class="el" href="classmlx_1_1core_1_1_arc_cos.html#aa48d8bec4efbac569d809cf11648b739">mlx::core::ArcCos</a>, <a class="el" href="classmlx_1_1core_1_1_arc_cosh.html#a6a9a2ab0cc360d7e2f9676db17f8e630">mlx::core::ArcCosh</a>, <a class="el" href="classmlx_1_1core_1_1_arc_sin.html#a895a35c9dd22fdb06e7b971bfd6fde87">mlx::core::ArcSin</a>, <a class="el" href="classmlx_1_1core_1_1_arc_sinh.html#aa8b2934a8a0b2eedec8257bbb5726430">mlx::core::ArcSinh</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tan.html#ab0309e4feca36f221b3d672dc92cac05">mlx::core::ArcTan</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tan2.html#abdfef9f572d06df1251c28222756a361">mlx::core::ArcTan2</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tanh.html#aa9549311240d7ba225b84e1df9ad8523">mlx::core::ArcTanh</a>, <a class="el" href="classmlx_1_1core_1_1_arg_partition.html#aa8678d94fa1571ea71a7bf790cdb8d63">mlx::core::ArgPartition</a>, <a class="el" href="classmlx_1_1core_1_1_arg_reduce.html#a153a6d8dba7301c4fcd0e429154ead8f">mlx::core::ArgReduce</a>, <a class="el" href="classmlx_1_1core_1_1_arg_sort.html#a0b59ce43e0982d634a01631728b419bd">mlx::core::ArgSort</a>, <a class="el" href="classmlx_1_1core_1_1_as_type.html#aa617e29147c14bd5d1fa8ad0bf65af0c">mlx::core::AsType</a>, <a class="el" href="classmlx_1_1core_1_1_as_strided.html#af2e21b77ea9e6c70bca45224967745bf">mlx::core::AsStrided</a>, <a class="el" href="classmlx_1_1core_1_1_bitwise_binary.html#a69b28e239da7fdb89f0a9f9467dd797d">mlx::core::BitwiseBinary</a>, <a class="el" href="classmlx_1_1core_1_1_block_masked_m_m.html#a37ecf6fa296d28efb7651a3c510fe159">mlx::core::BlockMaskedMM</a>, <a class="el" href="classmlx_1_1core_1_1_gather_m_m.html#ae7a6f4eecb15e95b21e6c87068ebd758">mlx::core::GatherMM</a>, <a class="el" href="classmlx_1_1core_1_1_broadcast.html#a6a610412861c6e472f930b6721b99a11">mlx::core::Broadcast</a>, <a class="el" href="classmlx_1_1core_1_1_ceil.html#a14a0048dd6496341cacaddada68276ee">mlx::core::Ceil</a>, <a class="el" href="classmlx_1_1core_1_1_compiled.html#a271521f92eef49c39799f38e26b64a9b">mlx::core::Compiled</a>, <a class="el" href="classmlx_1_1core_1_1_concatenate.html#a56f29b585a6d1d958954a68dcc893f33">mlx::core::Concatenate</a>, <a class="el" href="classmlx_1_1core_1_1_conjugate.html#a40281539bbd543ac8fd8e28650de17e4">mlx::core::Conjugate</a>, <a class="el" href="classmlx_1_1core_1_1_convolution.html#a844eab7c4cc99e775cfb561265ed14fd">mlx::core::Convolution</a>, <a class="el" href="classmlx_1_1core_1_1_copy.html#acfa1a02ab9cdab593e928faa515a8008">mlx::core::Copy</a>, <a class="el" href="classmlx_1_1core_1_1_cos.html#a81858457e4bea931a4bc6f6e38b0f696">mlx::core::Cos</a>, <a class="el" href="classmlx_1_1core_1_1_cosh.html#ac247faad68c1050cda9f72d7d6d040e2">mlx::core::Cosh</a>, <a class="el" href="classmlx_1_1core_1_1_custom_transforms.html#a2ddbacbc468271b11caee0ad97005298">mlx::core::CustomTransforms</a>, <a class="el" href="classmlx_1_1core_1_1_depends.html#aed575b0d927f4341f60442c70adeeb82">mlx::core::Depends</a>, <a class="el" href="classmlx_1_1core_1_1_divide.html#af3c15337ac15522cc34ed98b97895bb6">mlx::core::Divide</a>, <a class="el" href="classmlx_1_1core_1_1_div_mod.html#a7edbed50d07869d921e529157931b7a1">mlx::core::DivMod</a>, <a class="el" href="classmlx_1_1core_1_1_select.html#a678285f2c0b9dae85692399c3aa692a7">mlx::core::Select</a>, <a class="el" href="classmlx_1_1core_1_1_remainder.html#aeaecac5ea8e606d7ecd393d8019029e4">mlx::core::Remainder</a>, <a class="el" href="classmlx_1_1core_1_1_equal.html#a0787bf32f0b405a8b2ac809d2d990774">mlx::core::Equal</a>, <a class="el" href="classmlx_1_1core_1_1_erf.html#a186af7b783cf832c3b25eec3a09f5a0c">mlx::core::Erf</a>, <a class="el" href="classmlx_1_1core_1_1_erf_inv.html#a0acb31bd5780abf61877bd1a3e0fd4f9">mlx::core::ErfInv</a>, <a class="el" href="classmlx_1_1core_1_1_exp.html#ad87cc1b2ae595a613b03b0fdca63ae6a">mlx::core::Exp</a>, <a class="el" href="classmlx_1_1core_1_1_expm1.html#af1a99266fc50aa5948cdd298e2916ef1">mlx::core::Expm1</a>, <a class="el" href="classmlx_1_1core_1_1_f_f_t.html#a15a2a5f7647f5fb78611a251d3270edf">mlx::core::FFT</a>, <a class="el" href="classmlx_1_1core_1_1_floor.html#ac289e87c5fac15e2f491e2513be610f6">mlx::core::Floor</a>, <a class="el" href="classmlx_1_1core_1_1_full.html#a68e08303f4960ab373b84a3312edc013">mlx::core::Full</a>, <a class="el" href="classmlx_1_1core_1_1_gather.html#a9d57637a8a65008683c3847251bdcf91">mlx::core::Gather</a>, <a class="el" href="classmlx_1_1core_1_1_greater.html#aa2980e45cd2c79ebfb394012d3108a04">mlx::core::Greater</a>, <a class="el" href="classmlx_1_1core_1_1_greater_equal.html#ab98045c861d2d2ffb0398c2c1d671cef">mlx::core::GreaterEqual</a>, <a class="el" href="classmlx_1_1core_1_1_hadamard.html#a3df6e7e3b3b71bf50be5f1a05d0870b6">mlx::core::Hadamard</a>, <a class="el" href="classmlx_1_1core_1_1_less.html#ad67e6f66d7b75546fd98dbee6b631d78">mlx::core::Less</a>, <a class="el" href="classmlx_1_1core_1_1_less_equal.html#a409842d3862113c53cbbdf7467a06950">mlx::core::LessEqual</a>, <a class="el" href="classmlx_1_1core_1_1_load.html#a54e08a0ca41b7c9f1a76b00c889f0bfa">mlx::core::Load</a>, <a class="el" href="classmlx_1_1core_1_1_log.html#a7b946d98d4a228c6be9f606a3bd8a30d">mlx::core::Log</a>, <a class="el" href="classmlx_1_1core_1_1_log1p.html#a8a1569dde30440ce11ea466ccc69d2d4">mlx::core::Log1p</a>, <a class="el" href="classmlx_1_1core_1_1_logical_not.html#a001ff3eca46440f0d8a287e0b98a8a2c">mlx::core::LogicalNot</a>, <a class="el" href="classmlx_1_1core_1_1_logical_and.html#a9a5220eb56e1fd94fd879394ee5ad397">mlx::core::LogicalAnd</a>, <a class="el" href="classmlx_1_1core_1_1_logical_or.html#a6becc5fbfadde850de9857099dcd5003">mlx::core::LogicalOr</a>, <a class="el" href="classmlx_1_1core_1_1_log_add_exp.html#a702a2eff0bd1ae7b6fb829dd0b0b11b9">mlx::core::LogAddExp</a>, <a class="el" href="classmlx_1_1core_1_1_matmul.html#abb4a16a265a05d56a2f5d2e89d6f9dfd">mlx::core::Matmul</a>, <a class="el" href="classmlx_1_1core_1_1_maximum.html#a3b708a1d6b526719c62850294776f8ca">mlx::core::Maximum</a>, <a class="el" href="classmlx_1_1core_1_1_minimum.html#a137677bf32c626a768b732a7b8575512">mlx::core::Minimum</a>, <a class="el" href="classmlx_1_1core_1_1_multiply.html#aa4f1f7af68346ce80c2636df415c9909">mlx::core::Multiply</a>, <a class="el" href="classmlx_1_1core_1_1_negative.html#a0d5c30e267ff6468d64f1987f9f83f91">mlx::core::Negative</a>, <a class="el" href="classmlx_1_1core_1_1_not_equal.html#a12aa2f764880d29e627540610b63af09">mlx::core::NotEqual</a>, <a class="el" href="classmlx_1_1core_1_1_number_of_elements.html#aecde30826970938f3aa688979a668f52">mlx::core::NumberOfElements</a>, <a class="el" href="classmlx_1_1core_1_1_pad.html#af87754daaf51f6a6cf8bd4949ca1e70a">mlx::core::Pad</a>, <a class="el" href="classmlx_1_1core_1_1_partition.html#ab5c7aa4fed325475b33d4004649f0dc0">mlx::core::Partition</a>, <a class="el" href="classmlx_1_1core_1_1_power.html#a33e2d7ff078426fe66ea2370ceb5af60">mlx::core::Power</a>, <a class="el" href="classmlx_1_1core_1_1_quantized_matmul.html#aaef8c96d4d40b4fa08ced540d341a4db">mlx::core::QuantizedMatmul</a>, <a class="el" href="classmlx_1_1core_1_1_gather_q_m_m.html#a53c3fa7beb51ce2e1c2da28633406fe0">mlx::core::GatherQMM</a>, <a class="el" href="classmlx_1_1core_1_1_random_bits.html#a8a5593c34fd868d94b36a8ced1390271">mlx::core::RandomBits</a>, <a class="el" href="classmlx_1_1core_1_1_reshape.html#a0f2323d5d67ece0eb25ecff565b21862">mlx::core::Reshape</a>, <a class="el" href="classmlx_1_1core_1_1_reduce.html#a399be3a89553787a0a687706881f03cd">mlx::core::Reduce</a>, <a class="el" href="classmlx_1_1core_1_1_round.html#af0dfe8943109c936b35ab0082f566f72">mlx::core::Round</a>, <a class="el" href="classmlx_1_1core_1_1_scan.html#ad5b6308c79e9b985a49df35eadd15b22">mlx::core::Scan</a>, <a class="el" href="classmlx_1_1core_1_1_scatter.html#aa9d45cbfb27b814517f6016092b30efa">mlx::core::Scatter</a>, <a class="el" href="classmlx_1_1core_1_1_sigmoid.html#ad4cd19938e5159754aa7516f405580c2">mlx::core::Sigmoid</a>, <a class="el" href="classmlx_1_1core_1_1_sign.html#a2aa0720fe0a6d2408eb43c25d3d45b0a">mlx::core::Sign</a>, <a class="el" href="classmlx_1_1core_1_1_sin.html#a73b31005551015897f15c00e8b0222e4">mlx::core::Sin</a>, <a class="el" href="classmlx_1_1core_1_1_sinh.html#a5b4753d52e80799d4fea0b9172d25a77">mlx::core::Sinh</a>, <a class="el" href="classmlx_1_1core_1_1_slice.html#a50851148948d924b71817cfbd4401504">mlx::core::Slice</a>, <a class="el" href="classmlx_1_1core_1_1_slice_update.html#a751eefb9922c56479b4b0de2ad45439b">mlx::core::SliceUpdate</a>, <a class="el" href="classmlx_1_1core_1_1_softmax.html#aa783610ef6b82b92681e78fc99412d83">mlx::core::Softmax</a>, <a class="el" href="classmlx_1_1core_1_1_sort.html#ada81b9343f80958174eba708452927a2">mlx::core::Sort</a>, <a class="el" href="classmlx_1_1core_1_1_split.html#ad0c31fe5972643cc75fde10445fc47f2">mlx::core::Split</a>, <a class="el" href="classmlx_1_1core_1_1_square.html#a75feb558cd1d615e96309dd7d1e81384">mlx::core::Square</a>, <a class="el" href="classmlx_1_1core_1_1_sqrt.html#a8681c8de2f50049848d320c47f713c0f">mlx::core::Sqrt</a>, <a class="el" href="classmlx_1_1core_1_1_stop_gradient.html#acc7a7d51cbf014dae8ba3d20bedcad50">mlx::core::StopGradient</a>, <a class="el" href="classmlx_1_1core_1_1_subtract.html#a3834fd305435fb5a8e512566832e372b">mlx::core::Subtract</a>, <a class="el" href="classmlx_1_1core_1_1_tan.html#aeea7c284d595a2a928d5f28a55e9be7f">mlx::core::Tan</a>, <a class="el" href="classmlx_1_1core_1_1_tanh.html#a73f4976d641daf697cc1a231d773d78e">mlx::core::Tanh</a>, <a class="el" href="classmlx_1_1core_1_1_uniform.html#a01510998719b19df137451cc37850b8d">mlx::core::Uniform</a>, <a class="el" href="classmlx_1_1core_1_1_view.html#a513b034919a8a494add3155f910a360c">mlx::core::View</a>, <a class="el" href="classmlx_1_1core_1_1_transpose.html#ac6c87b850f4e5560aa13a5e1e9f9fe04">mlx::core::Transpose</a>, <a class="el" href="classmlx_1_1core_1_1_q_r_f.html#aba3526722b3a52b41fa8103b909f7f3b">mlx::core::QRF</a>, <a class="el" href="classmlx_1_1core_1_1_s_v_d.html#ab87a4e7ef857936bea66ba9e24662f53">mlx::core::SVD</a>, <a class="el" href="classmlx_1_1core_1_1_inverse.html#a543f18f1ce5c06c897141091e95a66e9">mlx::core::Inverse</a>, and <a class="el" href="classmlx_1_1core_1_1_cholesky.html#a0a8b51ff7f5369d22bdc58910d4aaf84">mlx::core::Cholesky</a>.</p>

</div>
</div>
<a id="a46e6257397a662528f9f831842ac456a" name="a46e6257397a662528f9f831842ac456a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46e6257397a662528f9f831842ac456a">&#9670;&#160;</a></span>stream()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structmlx_1_1core_1_1_stream.html">Stream</a> &amp; mlx::core::Primitive::stream </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The stream the primitive will run on. </p>

</div>
</div>
<a id="a1dcb6807326eeab62474c6a0e3836d42" name="a1dcb6807326eeab62474c6a0e3836d42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dcb6807326eeab62474c6a0e3836d42">&#9670;&#160;</a></span>vjp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; mlx::core::Primitive::vjp </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>primals</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>cotangents</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>argnums</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>outputs</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The vector-Jacobian product. </p>

<p>Reimplemented in <a class="el" href="classmlx_1_1core_1_1_depends.html#a02996fa45f01f7cb9f37074d5f8ccab0">mlx::core::Depends</a>, <a class="el" href="classmlx_1_1core_1_1distributed_1_1_all_reduce.html#abbf6d1d63dcda207ad7d9eeb4fc36225">mlx::core::distributed::AllReduce</a>, <a class="el" href="classmlx_1_1core_1_1distributed_1_1_all_gather.html#aa5eff6fc128b71220899aab8ab9116fb">mlx::core::distributed::AllGather</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_custom.html#a74be4bcd0382f7f6400bf73fd5569c91">mlx::core::fast::Custom</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_r_m_s_norm.html#aacfbbbc15fcee0a5ce4f519ca3cca5eb">mlx::core::fast::RMSNorm</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_layer_norm.html#ae5e1b5df0705a6b1d141691a4396b0b6">mlx::core::fast::LayerNorm</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_ro_p_e.html#ad999105414badd66c8fd9e069454a533">mlx::core::fast::RoPE</a>, <a class="el" href="classmlx_1_1core_1_1_abs.html#aa2dd8ec0989e716b77394ac349b34592">mlx::core::Abs</a>, <a class="el" href="classmlx_1_1core_1_1_add.html#ac28e581862880e24ed2b99bb6a916607">mlx::core::Add</a>, <a class="el" href="classmlx_1_1core_1_1_add_m_m.html#ac1562a37cec6928e01281926ebeb47c6">mlx::core::AddMM</a>, <a class="el" href="classmlx_1_1core_1_1_arc_cos.html#a78e73e5e639d1249c7fe9614bf157c92">mlx::core::ArcCos</a>, <a class="el" href="classmlx_1_1core_1_1_arc_cosh.html#a856c677f16e2b3f2edd2491e35db2d26">mlx::core::ArcCosh</a>, <a class="el" href="classmlx_1_1core_1_1_arc_sin.html#ab4057cd5ef1a8359f97493018e10d3a1">mlx::core::ArcSin</a>, <a class="el" href="classmlx_1_1core_1_1_arc_sinh.html#a7988ee5b9e1e7e498dcab73d61ba147e">mlx::core::ArcSinh</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tan.html#a5fefc3634b96a67ff8ae011a8ee180c2">mlx::core::ArcTan</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tan2.html#a99840c282e37b2b2a9c312e6e8ade1d2">mlx::core::ArcTan2</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tanh.html#a07da5797f7aaf3dfe43bf24e8562ac72">mlx::core::ArcTanh</a>, <a class="el" href="classmlx_1_1core_1_1_as_type.html#ac38a4f889311a3b5e5be9a67dcb93e18">mlx::core::AsType</a>, <a class="el" href="classmlx_1_1core_1_1_as_strided.html#a34783284c9b2f5b4a62c3c3ee5dd4062">mlx::core::AsStrided</a>, <a class="el" href="classmlx_1_1core_1_1_bitwise_binary.html#a6131ed1c317ff8700a3e9b13fdaa9d61">mlx::core::BitwiseBinary</a>, <a class="el" href="classmlx_1_1core_1_1_block_masked_m_m.html#a1adf20087ee2f685bf39c2724b8e7120">mlx::core::BlockMaskedMM</a>, <a class="el" href="classmlx_1_1core_1_1_gather_m_m.html#a76c9f27c57354f6230b43944882e1bda">mlx::core::GatherMM</a>, <a class="el" href="classmlx_1_1core_1_1_broadcast.html#a0318847c9be40f00b23907ad56037d18">mlx::core::Broadcast</a>, <a class="el" href="classmlx_1_1core_1_1_ceil.html#ac2f5a2bd84b8f013e5ce688419a88acb">mlx::core::Ceil</a>, <a class="el" href="classmlx_1_1core_1_1_compiled.html#a32462e65c52f84b708188130cc508133">mlx::core::Compiled</a>, <a class="el" href="classmlx_1_1core_1_1_concatenate.html#a8155db9100ec3b8bd0bc94baeaeee3b0">mlx::core::Concatenate</a>, <a class="el" href="classmlx_1_1core_1_1_convolution.html#af8eb9c0c055ad20aa74b547016917690">mlx::core::Convolution</a>, <a class="el" href="classmlx_1_1core_1_1_copy.html#a6c4dee582001e9983e9517485ee37efd">mlx::core::Copy</a>, <a class="el" href="classmlx_1_1core_1_1_cos.html#a51d84113728e651ef9d4a1fe671c4d00">mlx::core::Cos</a>, <a class="el" href="classmlx_1_1core_1_1_cosh.html#a0791abd4305a333fb3b181a5357ce0f4">mlx::core::Cosh</a>, <a class="el" href="classmlx_1_1core_1_1_custom_transforms.html#aa1da36cef632df767cd9809d6cf06209">mlx::core::CustomTransforms</a>, <a class="el" href="classmlx_1_1core_1_1_divide.html#ad3af7c70cad22c1a1a75b4a78ef793b6">mlx::core::Divide</a>, <a class="el" href="classmlx_1_1core_1_1_div_mod.html#a8c914a07f666a1d9377a27ed5d55e7c1">mlx::core::DivMod</a>, <a class="el" href="classmlx_1_1core_1_1_select.html#a9b522487b78fceeca7f827cd1c29a9a3">mlx::core::Select</a>, <a class="el" href="classmlx_1_1core_1_1_remainder.html#ab18f7bca1027ae71847a50da0933cec6">mlx::core::Remainder</a>, <a class="el" href="classmlx_1_1core_1_1_equal.html#af3c1bfcd1bf50922fc00e302bb193736">mlx::core::Equal</a>, <a class="el" href="classmlx_1_1core_1_1_erf.html#a1f529e95a42a2d69a8b18979d3ee2909">mlx::core::Erf</a>, <a class="el" href="classmlx_1_1core_1_1_erf_inv.html#a48afff12a58ddefae7ae0245c3580189">mlx::core::ErfInv</a>, <a class="el" href="classmlx_1_1core_1_1_exp.html#a94b9b7d137c3640d290b96c5e8b7e1a8">mlx::core::Exp</a>, <a class="el" href="classmlx_1_1core_1_1_expm1.html#af6ce416169190479c9792bb9cdbe2f43">mlx::core::Expm1</a>, <a class="el" href="classmlx_1_1core_1_1_f_f_t.html#aafc895614a6e368c0e6d64af20d01090">mlx::core::FFT</a>, <a class="el" href="classmlx_1_1core_1_1_floor.html#a589e2cf99b6fd1a5ba85534a2a31338e">mlx::core::Floor</a>, <a class="el" href="classmlx_1_1core_1_1_full.html#a49e76e7a8641f990701abc1b3bd49969">mlx::core::Full</a>, <a class="el" href="classmlx_1_1core_1_1_gather.html#aacf612a8f5f1cdbbfd19707d8d33c426">mlx::core::Gather</a>, <a class="el" href="classmlx_1_1core_1_1_greater.html#a341766a8a7e41d2a1160d35d4e781679">mlx::core::Greater</a>, <a class="el" href="classmlx_1_1core_1_1_greater_equal.html#a62f07a4ac54c708307c82aac0e5693ee">mlx::core::GreaterEqual</a>, <a class="el" href="classmlx_1_1core_1_1_hadamard.html#af4134775427b8998d66f489468b98656">mlx::core::Hadamard</a>, <a class="el" href="classmlx_1_1core_1_1_less.html#aaf205d389b5e602e0814b68f66de8f50">mlx::core::Less</a>, <a class="el" href="classmlx_1_1core_1_1_less_equal.html#aab2aab7590c299885e815c18eedd1028">mlx::core::LessEqual</a>, <a class="el" href="classmlx_1_1core_1_1_log.html#a40885dccfbf928c4d035881be1d49280">mlx::core::Log</a>, <a class="el" href="classmlx_1_1core_1_1_log1p.html#a3113c1d2b4c5e73d0b470f42dc48a880">mlx::core::Log1p</a>, <a class="el" href="classmlx_1_1core_1_1_logical_not.html#af2c3c241cf3910fbaba013c69d052a50">mlx::core::LogicalNot</a>, <a class="el" href="classmlx_1_1core_1_1_logical_and.html#ae42f8fc454577b0fd6410cae9d5f3b54">mlx::core::LogicalAnd</a>, <a class="el" href="classmlx_1_1core_1_1_logical_or.html#a51aed488f52d5031998689af9cb17847">mlx::core::LogicalOr</a>, <a class="el" href="classmlx_1_1core_1_1_log_add_exp.html#ae231af0ed24a93eb647ee58c2d2b20b4">mlx::core::LogAddExp</a>, <a class="el" href="classmlx_1_1core_1_1_matmul.html#a524136cca481598ea20894d85ca66bb0">mlx::core::Matmul</a>, <a class="el" href="classmlx_1_1core_1_1_maximum.html#a7de15d7b28784e24bbfc7e85ddcbcff3">mlx::core::Maximum</a>, <a class="el" href="classmlx_1_1core_1_1_minimum.html#a48a0cbe3a6c4f7473c00e343f63b5204">mlx::core::Minimum</a>, <a class="el" href="classmlx_1_1core_1_1_multiply.html#a74b7556ec03e2c3d3f971666d06f5db1">mlx::core::Multiply</a>, <a class="el" href="classmlx_1_1core_1_1_negative.html#a889585f056d33bda30c30311257af52a">mlx::core::Negative</a>, <a class="el" href="classmlx_1_1core_1_1_not_equal.html#a0361f29f4ae1235bdf3f3304527e2d4b">mlx::core::NotEqual</a>, <a class="el" href="classmlx_1_1core_1_1_pad.html#ad8a7e547644f2717a24322968e971038">mlx::core::Pad</a>, <a class="el" href="classmlx_1_1core_1_1_partition.html#a7110772b6cd2d430a2b825cf5c952ca9">mlx::core::Partition</a>, <a class="el" href="classmlx_1_1core_1_1_power.html#a1453bb8307d6ff33134f1e00263bf082">mlx::core::Power</a>, <a class="el" href="classmlx_1_1core_1_1_quantized_matmul.html#acb975e272b4a88ab232ef7f7c3a2bf26">mlx::core::QuantizedMatmul</a>, <a class="el" href="classmlx_1_1core_1_1_gather_q_m_m.html#ae08a4b7d28902d46f39e66beeb0e23ab">mlx::core::GatherQMM</a>, <a class="el" href="classmlx_1_1core_1_1_reshape.html#ab17294ecc6b5d4e89626fb48c7516365">mlx::core::Reshape</a>, <a class="el" href="classmlx_1_1core_1_1_reduce.html#a684883d2a96315f548ca769510e28e4e">mlx::core::Reduce</a>, <a class="el" href="classmlx_1_1core_1_1_round.html#af8f085e08b7fa8840c52a20b12ca35ce">mlx::core::Round</a>, <a class="el" href="classmlx_1_1core_1_1_scan.html#aaf13f72620b4b5d6a20e1228930e848e">mlx::core::Scan</a>, <a class="el" href="classmlx_1_1core_1_1_scatter.html#a0b51287fba789bb139ed61d40a0c636a">mlx::core::Scatter</a>, <a class="el" href="classmlx_1_1core_1_1_sigmoid.html#aac2f56a4c8362e36a28e232758ca52cf">mlx::core::Sigmoid</a>, <a class="el" href="classmlx_1_1core_1_1_sign.html#aa60ac52edd739fbdf388a997acd01bce">mlx::core::Sign</a>, <a class="el" href="classmlx_1_1core_1_1_sin.html#aedefe550ab4b0687858981bc0bcfbfa0">mlx::core::Sin</a>, <a class="el" href="classmlx_1_1core_1_1_sinh.html#a6b39fdd429bbb4de389e7c904fd561f0">mlx::core::Sinh</a>, <a class="el" href="classmlx_1_1core_1_1_slice.html#a291746a527ff991b66249fb2b54b685f">mlx::core::Slice</a>, <a class="el" href="classmlx_1_1core_1_1_slice_update.html#aedcdc60a0477997a96306c02b66d3f77">mlx::core::SliceUpdate</a>, <a class="el" href="classmlx_1_1core_1_1_softmax.html#abb68c311c45ee422a7c966accde9041b">mlx::core::Softmax</a>, <a class="el" href="classmlx_1_1core_1_1_sort.html#a3a8900dce53ee4eb7a1b83806e629358">mlx::core::Sort</a>, <a class="el" href="classmlx_1_1core_1_1_split.html#a7e8730f9cffa9872fff6f8d577031674">mlx::core::Split</a>, <a class="el" href="classmlx_1_1core_1_1_square.html#abcd9516da7f02dc906368c23b0bca263">mlx::core::Square</a>, <a class="el" href="classmlx_1_1core_1_1_sqrt.html#a08a21bd2c3a016f042d95aca294e68f3">mlx::core::Sqrt</a>, <a class="el" href="classmlx_1_1core_1_1_subtract.html#a3a3322be7c3bcaa0397cf099091df16b">mlx::core::Subtract</a>, <a class="el" href="classmlx_1_1core_1_1_tan.html#a4639836cff03d73c769387d6943e92d7">mlx::core::Tan</a>, <a class="el" href="classmlx_1_1core_1_1_tanh.html#afe7b05e2b36b99c3a1b66f0cd3544e95">mlx::core::Tanh</a>, and <a class="el" href="classmlx_1_1core_1_1_transpose.html#ac7805aa29b34afdf8852554f1e759f80">mlx::core::Transpose</a>.</p>

</div>
</div>
<a id="ac632b9619dd7a6a0f177bd36202e8103" name="ac632b9619dd7a6a0f177bd36202e8103"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac632b9619dd7a6a0f177bd36202e8103">&#9670;&#160;</a></span>vmap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::pair&lt; std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt;, std::vector&lt; int &gt; &gt; mlx::core::Primitive::vmap </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmlx_1_1core_1_1array.html">array</a> &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>inputs</em>, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>axes</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The primitive must know how to vectorize itself across the given axes. </p>
<p>The output is a pair containing the output arrays representing the vectorized computation and the axes which corresponds to the vectorized dimensions of each output. </p>

<p>Reimplemented in <a class="el" href="classmlx_1_1core_1_1distributed_1_1_all_reduce.html#a3f2dc71859847ca675ec4bfbe125035a">mlx::core::distributed::AllReduce</a>, <a class="el" href="classmlx_1_1core_1_1distributed_1_1_all_gather.html#ad532d1d51f089dec3c84799b724ea031">mlx::core::distributed::AllGather</a>, <a class="el" href="classmlx_1_1core_1_1fast_1_1_custom.html#a7f4c3a4c48c6807faa36fb31e39dad8d">mlx::core::fast::Custom</a>, <a class="el" href="classmlx_1_1core_1_1_abs.html#a4c9c98f1d71432fd3752ad9a6a8e7f2f">mlx::core::Abs</a>, <a class="el" href="classmlx_1_1core_1_1_add.html#a0e557d4d896153f84a25532562e4c646">mlx::core::Add</a>, <a class="el" href="classmlx_1_1core_1_1_add_m_m.html#a73ce80b3a37ec2523943028d50ebce81">mlx::core::AddMM</a>, <a class="el" href="classmlx_1_1core_1_1_arc_cos.html#a7548e23ace6827674aa6d284d44ccf83">mlx::core::ArcCos</a>, <a class="el" href="classmlx_1_1core_1_1_arc_cosh.html#af8ff78e910a9e485a203e1d3347bd461">mlx::core::ArcCosh</a>, <a class="el" href="classmlx_1_1core_1_1_arc_sin.html#a7cabb1e5a2bda44944378822c671ec82">mlx::core::ArcSin</a>, <a class="el" href="classmlx_1_1core_1_1_arc_sinh.html#a9e72b9751939387c333b5d4e19a37f6d">mlx::core::ArcSinh</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tan.html#a1fb921554544a56498bc54f82e4a0556">mlx::core::ArcTan</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tan2.html#ae02cb9fbf25e93dc1d7fbc9e3fb28634">mlx::core::ArcTan2</a>, <a class="el" href="classmlx_1_1core_1_1_arc_tanh.html#a6ddcae68873559211cb91e7740dfc040">mlx::core::ArcTanh</a>, <a class="el" href="classmlx_1_1core_1_1_arg_partition.html#a441093795bcc31495ab5fbc9957b740a">mlx::core::ArgPartition</a>, <a class="el" href="classmlx_1_1core_1_1_arg_reduce.html#abfec42fa06ea15edaf393593751fb1ba">mlx::core::ArgReduce</a>, <a class="el" href="classmlx_1_1core_1_1_arg_sort.html#a3522bbbe4626a467394c1a8a9d7ac34e">mlx::core::ArgSort</a>, <a class="el" href="classmlx_1_1core_1_1_as_type.html#a7ebaf86fd6cad4a1ecfd7cde1ee0b0cc">mlx::core::AsType</a>, <a class="el" href="classmlx_1_1core_1_1_bitwise_binary.html#aa10be55f05bc1868bf4b375dc475f965">mlx::core::BitwiseBinary</a>, <a class="el" href="classmlx_1_1core_1_1_broadcast.html#aee4c71c2588ad01eb57e10f346cd666f">mlx::core::Broadcast</a>, <a class="el" href="classmlx_1_1core_1_1_ceil.html#ae86819990b43bdb0c2b3a25719b3a7a4">mlx::core::Ceil</a>, <a class="el" href="classmlx_1_1core_1_1_compiled.html#a732e7548f53977b4513bb7f30a04c30d">mlx::core::Compiled</a>, <a class="el" href="classmlx_1_1core_1_1_concatenate.html#a58c54dcf8e4b045d25edd3afc2caffc1">mlx::core::Concatenate</a>, <a class="el" href="classmlx_1_1core_1_1_conjugate.html#a2c7632c8ae0ca07777e23a0a79344e60">mlx::core::Conjugate</a>, <a class="el" href="classmlx_1_1core_1_1_copy.html#a669b10253c15b769d90058d1ad7d0e61">mlx::core::Copy</a>, <a class="el" href="classmlx_1_1core_1_1_cos.html#aec9460daf0131156734013d03b230cd6">mlx::core::Cos</a>, <a class="el" href="classmlx_1_1core_1_1_cosh.html#a1ab2386e7d96219b6e4a525f7dac0406">mlx::core::Cosh</a>, <a class="el" href="classmlx_1_1core_1_1_custom_transforms.html#a906a2ff30d9c5281fbf1fa927e4c021b">mlx::core::CustomTransforms</a>, <a class="el" href="classmlx_1_1core_1_1_divide.html#a83e7da52831165b3a026e97b63770242">mlx::core::Divide</a>, <a class="el" href="classmlx_1_1core_1_1_div_mod.html#ae709e0fdd83994bd1d156e0d0e6a7942">mlx::core::DivMod</a>, <a class="el" href="classmlx_1_1core_1_1_select.html#a84e80361c8cf02536b4b98098793550f">mlx::core::Select</a>, <a class="el" href="classmlx_1_1core_1_1_remainder.html#a79867e1099a2e3c2d3e87407b2ab6e3d">mlx::core::Remainder</a>, <a class="el" href="classmlx_1_1core_1_1_equal.html#aea9cc3c88924ac824d72c39c2e83b0ca">mlx::core::Equal</a>, <a class="el" href="classmlx_1_1core_1_1_erf.html#abe554f553356654a3e800ba368108aaa">mlx::core::Erf</a>, <a class="el" href="classmlx_1_1core_1_1_erf_inv.html#ad5d7634e8568af8cc4a54a558a48d0e9">mlx::core::ErfInv</a>, <a class="el" href="classmlx_1_1core_1_1_exp.html#a0fcd579fe148b4c3dbc72e514b81bb37">mlx::core::Exp</a>, <a class="el" href="classmlx_1_1core_1_1_expm1.html#aa4caa848b2ea97e71ee3dd33de039296">mlx::core::Expm1</a>, <a class="el" href="classmlx_1_1core_1_1_f_f_t.html#ac32d6cc9b67289124f855ea68a61ede1">mlx::core::FFT</a>, <a class="el" href="classmlx_1_1core_1_1_floor.html#aea4dc79a65774990e775ad49519a5d10">mlx::core::Floor</a>, <a class="el" href="classmlx_1_1core_1_1_full.html#afc57ab6bd9ebdbbf042af54a59785d95">mlx::core::Full</a>, <a class="el" href="classmlx_1_1core_1_1_gather.html#abab0c4c204e66489825ce80d2194a275">mlx::core::Gather</a>, <a class="el" href="classmlx_1_1core_1_1_greater.html#a6d8267411fc4951de781f9e8e6c53aa0">mlx::core::Greater</a>, <a class="el" href="classmlx_1_1core_1_1_greater_equal.html#ab0e1be93eb01b0ce7fa83e953f5e3e1d">mlx::core::GreaterEqual</a>, <a class="el" href="classmlx_1_1core_1_1_hadamard.html#a9f1a172e6246859e813002abe9b8f99c">mlx::core::Hadamard</a>, <a class="el" href="classmlx_1_1core_1_1_less.html#a5fee5956cf087d8405359121aa62ba7e">mlx::core::Less</a>, <a class="el" href="classmlx_1_1core_1_1_less_equal.html#a3d5df21db184f2b7620cda9da1684480">mlx::core::LessEqual</a>, <a class="el" href="classmlx_1_1core_1_1_log.html#a007ddbcf911093231f607a8b9ed5cd49">mlx::core::Log</a>, <a class="el" href="classmlx_1_1core_1_1_log1p.html#a7122576f95ce479926bbbbc690891f71">mlx::core::Log1p</a>, <a class="el" href="classmlx_1_1core_1_1_logical_not.html#a5308a271619ee74df561b0aaf525915d">mlx::core::LogicalNot</a>, <a class="el" href="classmlx_1_1core_1_1_logical_and.html#aacc5f6f53ffc327b7771485e3da2a4e5">mlx::core::LogicalAnd</a>, <a class="el" href="classmlx_1_1core_1_1_logical_or.html#a6e2e77e6aaf47872b2e96b151c32daf3">mlx::core::LogicalOr</a>, <a class="el" href="classmlx_1_1core_1_1_log_add_exp.html#a82190aa1421a9734b6e9480debffac78">mlx::core::LogAddExp</a>, <a class="el" href="classmlx_1_1core_1_1_matmul.html#a3a1c6e70bac300240760fe41a58340c2">mlx::core::Matmul</a>, <a class="el" href="classmlx_1_1core_1_1_maximum.html#ab664918e0d71cfec1318a9879e78c5d3">mlx::core::Maximum</a>, <a class="el" href="classmlx_1_1core_1_1_minimum.html#adab0f31acf68075a0be908d8eb882980">mlx::core::Minimum</a>, <a class="el" href="classmlx_1_1core_1_1_multiply.html#ae7e82c8fc8cbaf4e00c27eb54fac7dbf">mlx::core::Multiply</a>, <a class="el" href="classmlx_1_1core_1_1_negative.html#a1f8a6079e272f1a0599f88a1a8419cf0">mlx::core::Negative</a>, <a class="el" href="classmlx_1_1core_1_1_not_equal.html#ab8b57932f03c8eee664bf89adeaa43b5">mlx::core::NotEqual</a>, <a class="el" href="classmlx_1_1core_1_1_number_of_elements.html#a977d83eae845b8bd8c0b98b48cb1c6c2">mlx::core::NumberOfElements</a>, <a class="el" href="classmlx_1_1core_1_1_pad.html#a85658812a0f3275ba3eb74b7c75686cf">mlx::core::Pad</a>, <a class="el" href="classmlx_1_1core_1_1_partition.html#aa0cc55e4d4d2cb5d129d32832321df2c">mlx::core::Partition</a>, <a class="el" href="classmlx_1_1core_1_1_power.html#a5e22749592413a9adbdc877b03b87c8f">mlx::core::Power</a>, <a class="el" href="classmlx_1_1core_1_1_quantized_matmul.html#a3434394140177b285f971c9ffe7e8763">mlx::core::QuantizedMatmul</a>, <a class="el" href="classmlx_1_1core_1_1_gather_q_m_m.html#a13ce5e138ebddb8780a034452f68892f">mlx::core::GatherQMM</a>, <a class="el" href="classmlx_1_1core_1_1_random_bits.html#a0dc12f053c6492f934bc18031412c415">mlx::core::RandomBits</a>, <a class="el" href="classmlx_1_1core_1_1_reshape.html#ae239dd3c6cab147e4af572dc58204f9d">mlx::core::Reshape</a>, <a class="el" href="classmlx_1_1core_1_1_reduce.html#abab1b5aa01ccad44f213f510c3596b38">mlx::core::Reduce</a>, <a class="el" href="classmlx_1_1core_1_1_round.html#a6fad8799a7982e1ccbe05be7cc38a7fd">mlx::core::Round</a>, <a class="el" href="classmlx_1_1core_1_1_scan.html#a297c7cc89c9bf9d186ebdebb634c7804">mlx::core::Scan</a>, <a class="el" href="classmlx_1_1core_1_1_sigmoid.html#a12712c23037e38192cbccd2d4b14cc85">mlx::core::Sigmoid</a>, <a class="el" href="classmlx_1_1core_1_1_sign.html#aa7296045907015b4e0ae8a93e5e6e295">mlx::core::Sign</a>, <a class="el" href="classmlx_1_1core_1_1_sin.html#a45533996f3d72d9dd97d4c61cd684fba">mlx::core::Sin</a>, <a class="el" href="classmlx_1_1core_1_1_sinh.html#ae171df22bc34c32e31b8135dc4caa788">mlx::core::Sinh</a>, <a class="el" href="classmlx_1_1core_1_1_slice.html#ae33583b0db22fcfeae34dfe1c0e3eaa2">mlx::core::Slice</a>, <a class="el" href="classmlx_1_1core_1_1_slice_update.html#adbf1c76de6ab2f986758530d351d6fa3">mlx::core::SliceUpdate</a>, <a class="el" href="classmlx_1_1core_1_1_softmax.html#ad22d3dcc71054d3dba529cf2dc981e19">mlx::core::Softmax</a>, <a class="el" href="classmlx_1_1core_1_1_sort.html#abfabb9e625cc0cb9335c7454ed27505c">mlx::core::Sort</a>, <a class="el" href="classmlx_1_1core_1_1_split.html#ab7c40e02a842e83bdb4698608472c7a6">mlx::core::Split</a>, <a class="el" href="classmlx_1_1core_1_1_square.html#a55bf43f878d4741c57a08d5fef472ea5">mlx::core::Square</a>, <a class="el" href="classmlx_1_1core_1_1_sqrt.html#a9d30e306ce08980c27d98c898577017e">mlx::core::Sqrt</a>, <a class="el" href="classmlx_1_1core_1_1_stop_gradient.html#aca680c8befef81da414c4375b11b16b0">mlx::core::StopGradient</a>, <a class="el" href="classmlx_1_1core_1_1_subtract.html#aa98f960e621a767c8a03624fd292f098">mlx::core::Subtract</a>, <a class="el" href="classmlx_1_1core_1_1_tan.html#ae2f67ca2adc83b10009cf28498bf58b7">mlx::core::Tan</a>, <a class="el" href="classmlx_1_1core_1_1_tanh.html#a32df3564c1ecb858c1ba9f855376762f">mlx::core::Tanh</a>, <a class="el" href="classmlx_1_1core_1_1_uniform.html#ad795037d5b1820e98f4268f166609926">mlx::core::Uniform</a>, <a class="el" href="classmlx_1_1core_1_1_view.html#a2230d3e5f434fb2b888de50b529ac121">mlx::core::View</a>, <a class="el" href="classmlx_1_1core_1_1_transpose.html#a5ef848b69def9a246665b67e6e3ffdfe">mlx::core::Transpose</a>, <a class="el" href="classmlx_1_1core_1_1_s_v_d.html#a0366c958f6cdac8d1d9e1a4eda53fae8">mlx::core::SVD</a>, <a class="el" href="classmlx_1_1core_1_1_inverse.html#a98419b9f0b8a6c9185fe012d523552c2">mlx::core::Inverse</a>, and <a class="el" href="classmlx_1_1core_1_1_cholesky.html#ab5c3f6199ec3b399c91243a05d116aa5">mlx::core::Cholesky</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>mlx/<a class="el" href="primitives_8h_source.html">primitives.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
